# 常见问题 {#faq}

这里列举了一系列【高频问题】和【常见解决方案】。

如果以下方案未能解决，或者你有其他任何问题，欢迎到社区礼貌提问以获取帮助。

- [前往 Discord 频道](https://discord.gg/RegGQD3Fu6)
- [加入 QQ 交流群 (群号: 614617552)](https://jq.qq.com/?_wv=1027&k=iK97X7NS)

## ❓ 装完 `kivibot` 依赖后提示找不到 `kivi` 命令 {#no-kivi-cmd}

请确保配置好了 node 关键环境变量 `NODE_HOME`, 同时命令行能正常访问 node 和 npm 命令。

## ❓ 框架启动时报错，无法正常启动 {#start-error}

框架要求的 node 最低版本为 14，请确保当前安装的 node 版本符合要求。

## ❓ 登录时一直提示 server is busy {#server-is-busy}

可能是当前**网络环境异常**导致，尝试以下方案:

- 切换扫码登录模式，如果扫码异常参考[这里](#qrcode-limit)
- 如果可以，切换 WiFi 或移动数据与 WiFi 环境进行互换
- 尝试使用 `kivi fix --device` 命令修复设备 IMEI
- 等，没错，就是等，有时候服务器抽风，等一会儿就好
- 上面都不行？那完犊子，使用其他设备或服务器进行登录吧
- 还不行？可能是账号风控严重，尝试切换其他 QQ 账号登录

## ❓ 如何获取滑块验证码的 `ticket` {#get-ticket}

框架会自动复制滑块链接，如果没有请手动复制，然后进行以下操作:

1. 打开浏览器，按键盘上的【F12】或鼠标右键网页空白区域选择【检查】(审阅)，打开浏览器的【开发者工具】
2. 切换到开发者工具的【网络】(network)选项卡，点击【Fetch/XHR】按钮筛选请求
3. 在浏览器的地址栏粘贴复制好的滑块链接，按 Enter 键打开滑块验证页面
4. **正确滑动滑块**完成验证，**如果滑动完再次出现滑块，则需要再滑一次**
5. 在开发者工具下方的请求列表找到**最下面最新的一条**，单击它打开详情面板
6. 切换到详情面板的【预览】(preview)选项卡，在 `ticket` 字段的内容上鼠标右键【复制值】
7. 将复制的 `ticket` 粘贴到框架的命令行输入区，按 Enter 键确认

如果你使用的是移动设备，可以尝试[这个项目](https://github.com/mzdluo123/TxCaptchaHelper)的解决方案。

## ❓ 报错提示设备 QQ 版本过低 {#low-version}

尝试使用 `kivi fix --device` 命令修复设备 IMEI，然后选择【密码登录】+【短信验证码验证设备锁】的模式进行登录。

如果修复完登录仍然无效，尝试在**本地设备**上使用扫码模式登录。

如果还需要部署到服务器，可以尝试先在本地扫码登录后，将 `data/oicq` 目录（包含验证信息和设备文件）和 `kivi.json` 配置文件覆盖到服务器的框架目录再尝试登录。

如果仍然无法登录，可能是账号风控太严重，尝试切换其他 QQ 账号登录。

## ❓ 扫码提示环境异常，无法扫码 {#qrcode-limit}

你可以尝试以下**任意**方案绕过扫码限制:

- 切换【密码登录模式】进行登录
- 使用【IP 处于同一地域】的两台本地设备进行登录和扫码
- 使用代理将服务器 IP 和扫码设备的 IP 处于【同一地域】

## ❓ 如何切换登录协议，哪些可以同时在线 {#change-protocal}

目前共有四种设备类型可以**同时在线**，不会相互挤掉线:

- 手机（包括 iOS, Android 和 HarmonyOS 等）
- 电脑（包括 Windows, Win UWP, Linux 和 MacOS 等）
- 手表（包括 iWatch 和 Android Watch 等）
- 平板（包括 Android Pad 和 iPad 等）

登录协议标识对照：

- `1`: 安卓手机（手机）
- `2`: 安卓平板（平板）
- `3`: 安卓手表（手表）
- `4`: MacOS（电脑）
- `5`: iPad（平板）

如果需要切换登录协议，可以使用记事本或者 vscode 等文本编辑器打开框架目录下的配置文件 `kivi.json`，然后根据上述标识对照参考，编辑 `oicq_config` 字段的 `platform` 字段，重启框架生效。

## ❓ 消息指令安装插件失败，提示 timeout 超时 {#npm-timeout}

如果使用 `/plugin add <name>` 消息指令安装插件失败，提示 timeout 超时，可能是由于 npm 网络连接不通畅，尝试打开终端，执行以下命令**切换国内镜像源**:

```shell
npm config set registry https://registry.npmmirror.com
```

## ❓ 群消息发送失败，提示被风控 {#risk-management}

某些账号由于使用**新设备**、**新 IP** 或者是**新注册的账号**等原因，可能会被**风控**，时长因账号而异，一般而言，注册越久、等级越高、越经常登录的账号，越不容易被风控。

账号风控时，可能会有以下特征:

- 可能在最长几天之内都无法发送超过 2 个字节的群消息
- 长消息必须分片发送才能发送成功，风控时框架会自动尝试分片发送
- 可能被一定程度限制加群、加好友以及邀请入群的功能
- 可能无法发送合并转发，以及一些 XML 消息

风控**没有确切的持续时长和解决方案**，常见措施是在你的设备上多挂几天官方客户端，或者挂几天框架，但不装任何插件，不发长消息，等待自行恢复。

## ❓ 提示密码已泄露，被强制下线要求修改密码 {#password-leakage}

可能是**异地登录**的原因，请尝试打开设备锁，然后再重新登录。

## ❓ 无法设置在线状态、无法接收某些群事件 {#miss-events}

如果无法设置在线状态、无法接收某些群事件（戳一戳等）、无法正常接收一些 QQ 表情和 CQ 码等，可能是由于使用手表协议。**手表协议不支持这些功能**，推荐使用 iPad 协议，不仅功能全面，还可以手机电脑 Bot 三端同时在线。

## ❓ 只能接收群聊消息，无法接收私聊消息和群邀请 {#miss-private}

请检查当前设备的系统时间是否快了 1 分钟以上。

## ❓ 支持多账号、转账和红包等 API 吗 {#bad-reqeust}

KiviBot 🤖 致力于营造丰富、多元、共同进步的机器人生态。

🚫 严厉禁止使用本框架进行任何，包括但不限于【营销推广】、【引流】、【黄赌毒】、【诈骗】等的一切违反相关法律的行为。

框架不会考虑也更不会支持交易相关功能的 API，同时既不支持也不鼓励多账号行为，目前没有多账号的计划，以后也不会有。

> 理论上可以通过目录物理多开，实现多账号。
